(function(a){var d=null;a.jgrid.extend({searchGrid:function(h){h=a.extend({recreateFilter:false,drag:true,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,closeAfterSearch:false,closeOnEscape:false,multipleSearch:false,sopt:null,onClose:null},a.jgrid.search,h||{});return this.each(function(){function b(t){var D=t!==undefined,B=a("#"+v.p.id),N={};if(h.multipleSearch===false){N[h.sField]=t.rules[0].field;
N[h.sValue]=t.rules[0].data;N[h.sOper]=t.rules[0].op}else N[h.sFilter]=t;B[0].p.search=D;a.extend(B[0].p.postData,N);B.trigger("reloadGrid",[{page:1}]);h.closeAfterSearch&&x(a("#"+p))}function o(t){t=t!==undefined;var D=a("#"+v.p.id),B=[];D[0].p.search=t;if(h.multipleSearch===false)B[h.sField]=B[h.sValue]=B[h.sOper]="";else B[h.sFilter]="";a.extend(D[0].p.postData,B);D.trigger("reloadGrid",[{page:1}])}function x(t){if(h.onClose){var D=h.onClose(t);if(typeof D=="boolean"&&!D)return}t.hide();a(".jqgrid-overlay:first",
"#gbox_"+v.p.id).hide()}function s(){var t=a(".ui-searchFilter").length;if(t>1){var D=a("#"+p).css("zIndex");a("#"+p).css({zIndex:parseInt(D)+t})}a("#"+p).show();a(".jqgrid-overlay:first","#gbox_"+v.p.id).show();try{a(":input:visible","#"+p)[0].focus()}catch(B){}}var v=this;if(v.grid)if(a.fn.searchFilter){var p="fbox_"+v.p.id;h.recreateFilter===true&&a("#"+p).remove();if(a("#"+p).html()!=null){a.isFunction(h.beforeShowSearch)&&h.beforeShowSearch(a("#"+p));s();a.isFunction(h.afterShowSearch)&&h.afterShowSearch(a("#"+
p))}else{var m=[],j=a("#"+v.p.id).jqGrid("getGridParam","colNames"),q=a("#"+v.p.id).jqGrid("getGridParam","colModel"),f=["eq","ne","lt","le","gt","ge","bw","bn","in","ni","ew","en","cn","nc"],e,k,i,n;n=jQuery.fn.searchFilter.defaults.operators;if(h.sopt!=null){n=[];for(e=i=0;e<h.sopt.length;e++)if((k=a.inArray(h.sopt[e],f))!=-1){n[i]={op:h.sopt[e],text:h.odata[k]};i++}}var C;a.each(q,function(t,D){C=typeof D.search==="undefined"?true:D.search;hidden=D.hidden===true;soptions=a.extend({},{text:j[t],
itemval:D.index||D.name},this.searchoptions);ignoreHiding=soptions.searchhidden===true;if(typeof soptions.sopt=="undefined")soptions.sopt=h.sopt||f;i=0;soptions.ops=[];if(soptions.sopt.length>0)for(e=0;e<soptions.sopt.length;e++)if((k=a.inArray(soptions.sopt[e],f))!=-1){soptions.ops[i]={op:soptions.sopt[e],text:h.odata[k]};i++}if(typeof this.stype==="undefined")this.stype="text";if(this.stype=="select")if(soptions.dataUrl==null){var B;if(soptions.value)B=soptions.value;else if(this.editoptions)B=
this.editoptions.value;if(B){soptions.dataValues=[];if(typeof B==="string"){t=B.split(";");for(e=0;e<t.length;e++){D=t[e].split(":");soptions.dataValues[e]={value:D[0],text:D[1]}}}else if(typeof B==="object"){e=0;for(var N in B){soptions.dataValues[e]={value:N,text:B[N]};e++}}}}if(ignoreHiding&&C||C&&!hidden)m.push(soptions)});if(m.length>0){a("<div id='"+p+"' role='dialog' tabindex='-1'></div>").insertBefore("#gview_"+v.p.id);a("#"+p).searchFilter(m,{groupOps:h.groupOps,operators:n,onClose:x,resetText:h.Reset,
searchText:h.Find,windowTitle:h.caption,rulesText:h.rulesText,matchText:h.matchText,onSearch:b,onReset:o,stringResult:h.multipleSearch,ajaxSelectOptions:a.extend({},a.jgrid.ajaxOptions,v.p.ajaxSelectOptions||{})});a(".ui-widget-overlay","#"+p).remove();v.p.direction=="rtl"&&a(".ui-closer","#"+p).css("float","left");if(h.drag===true){a("#"+p+" table thead tr:first td:first").css("cursor","move");if(jQuery.fn.jqDrag)a("#"+p).jqDrag(a("#"+p+" table thead tr:first td:first"));else try{a("#"+p).draggable({handle:a("#"+
p+" table thead tr:first td:first")})}catch(O){}}if(h.multipleSearch===false){a(".ui-del, .ui-add, .ui-del, .ui-add-last, .matchText, .rulesText","#"+p).hide();a("select[name='groupOp']","#"+p).hide()}a.isFunction(h.onInitializeSearch)&&h.onInitializeSearch(a("#"+p));a.isFunction(h.beforeShowSearch)&&h.beforeShowSearch(a("#"+p));s();a.isFunction(h.afterShowSearch)&&h.afterShowSearch(a("#"+p));h.closeOnEscape===true&&a("#"+p).keydown(function(t){t.which==27&&x(a("#"+p))})}}}})},editGridRow:function(h,
b){d=b=a.extend({top:0,left:0,width:300,height:"auto",dataheight:"auto",modal:false,drag:true,resize:true,url:null,mtype:"POST",clearAfterAdd:true,closeAfterEdit:false,reloadAfterSubmit:true,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:false,jqModal:true,closeOnEscape:false,addedrow:"first",topinfo:"",bottominfo:"",saveicon:[],
closeicon:[],savekey:[false,13],navkeys:[false,38,40],checkOnSubmit:false,checkOnUpdate:false,_savedData:{},onClose:null,ajaxEditOptions:{},serializeEditData:null},a.jgrid.edit,b||{});return this.each(function(){function o(g,l){g==0?a("#pData","#"+i+"_2").addClass("ui-state-disabled"):a("#pData","#"+i+"_2").removeClass("ui-state-disabled");g==l?a("#nData","#"+i+"_2").addClass("ui-state-disabled"):a("#nData","#"+i+"_2").removeClass("ui-state-disabled")}function x(){var g=a(f).jqGrid("getDataIDs"),
l=a("#id_g","#"+i).val();return[a.inArray(l,g),g]}function s(){var g=true;a("#FormError","#"+i).hide();if(d.checkOnUpdate){c={};u={};v();H=a.extend({},c,u);if(R=q(H,d._savedData)){a("#"+k).data("disabled",true);a(".confirm","#"+n.themodal).show();g=false}}return g}function v(){a(".FormElement","#"+i).each(function(){var g=a(".customelement",this);if(g.length){var l=g[0].name;a.each(f.p.colModel,function(){if(this.name==l&&this.editoptions&&a.isFunction(this.editoptions.custom_value)){try{c[l]=this.editoptions.custom_value(a("#"+
l,"#"+i),"get");if(c[l]===undefined)throw"e1";}catch(r){r=="e1"?info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.novalue,jQuery.jgrid.edit.bClose):info_dialog(jQuery.jgrid.errors.errcap,r.message,jQuery.jgrid.edit.bClose)}return true}})}else switch(a(this).get(0).type){case "checkbox":if(a(this).attr("checked"))c[this.name]=a(this).val();else{g=a(this).attr("offval");c[this.name]=g}break;case "select-one":c[this.name]=a("option:selected",this).val();u[this.name]=
a("option:selected",this).text();break;case "select-multiple":c[this.name]=a(this).val();c[this.name]=c[this.name]?c[this.name].join(","):"";var z=[];a("option:selected",this).each(function(r,F){z[r]=a(F).text()});u[this.name]=z.join(",");break;case "password":case "text":case "textarea":case "button":c[this.name]=a(this).val();c[this.name]=!f.p.autoencode?c[this.name]:a.jgrid.htmlEncode(c[this.name]);break}});return true}function p(g,l,z,r){for(var F,w,y,J=0,E,P,G,S=[],I=false,X,Q,ba="",W=1;W<=r;W++)ba+=
"<td class='CaptionTD ui-widget-content'>&#160;</td><td class='DataTD ui-widget-content' style='white-space:pre'>&#160;</td>";if(g!="_empty")I=a(l).jqGrid("getInd",g);a(l.p.colModel).each(function(Y){F=this.name;P=(w=this.editrules&&this.editrules.edithidden==true?false:this.hidden===true?true:false)?"style='display:none'":"";if(F!=="cb"&&F!=="subgrid"&&this.editable===true&&F!=="rn"){if(I===false)E="";else if(F==l.p.ExpandColumn&&l.p.treeGrid===true)E=a("td:eq("+Y+")",l.rows[I]).text();else try{E=
a.unformat(a("td:eq("+Y+")",l.rows[I]),{colModel:this},Y)}catch(da){E=a("td:eq("+Y+")",l.rows[I]).html()}var U=a.extend({},this.editoptions||{},{id:F,name:F});frmopt=a.extend({},{elmprefix:"",elmsuffix:"",rowabove:false,rowcontent:""},this.formoptions||{});X=parseInt(frmopt.rowpos)||J+1;Q=parseInt((parseInt(frmopt.colpos)||1)*2);if(g=="_empty"&&U.defaultValue)E=a.isFunction(U.defaultValue)?U.defaultValue():U.defaultValue;if(!this.edittype)this.edittype="text";G=createEl(this.edittype,U,E,false,a.extend({},
a.jgrid.ajaxOptions,l.p.ajaxSelectOptions||{}));if(E==""&&this.edittype=="checkbox")E=a(G).attr("offval");if(d.checkOnSubmit||d.checkOnUpdate)d._savedData[F]=E;a(G).addClass("FormElement");y=a(z).find("tr[rowpos="+X+"]");if(frmopt.rowabove){U=a("<tr><td class='contentinfo' colspan='"+r*2+"'>"+frmopt.rowcontent+"</td></tr>");a(z).append(U);U[0].rp=X}if(y.length==0){y=a("<tr "+P+" rowpos='"+X+"'></tr>").addClass("FormData").attr("id","tr_"+F);a(y).append(ba);a(z).append(y);y[0].rp=X}a("td:eq("+(Q-2)+
")",y[0]).html(typeof frmopt.label==="undefined"?l.p.colNames[Y]:frmopt.label);a("td:eq("+(Q-1)+")",y[0]).append(frmopt.elmprefix).append(G).append(frmopt.elmsuffix);S[J]=Y;J++}});if(J>0){W=a("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(r*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+g+"'/></td></tr>");W[0].rp=J+999;a(z).append(W);if(d.checkOnSubmit||d.checkOnUpdate)d._savedData.id=g}return S}function m(g,l,z){var r,
F=0,w,y,J,E,P;if(d.checkOnSubmit||d.checkOnUpdate){d._savedData={};d._savedData.id=g}var G=l.p.colModel;if(g=="_empty"){a(G).each(function(){r=this.name;J=a.extend({},this.editoptions||{});y=a("#"+a.jgrid.jqID(r),"#"+z);if(y[0]!=null){E="";if(J.defaultValue){E=a.isFunction(J.defaultValue)?J.defaultValue():J.defaultValue;if(y[0].type=="checkbox"){P=E.toLowerCase();if(P.search(/(false|0|no|off|undefined)/i)<0&&P!==""){y[0].checked=true;y[0].defaultChecked=true;y[0].value=E}else y.attr({checked:"",defaultChecked:""})}else y.val(E)}else if(y[0].type==
"checkbox"){y[0].checked=false;y[0].defaultChecked=false;E=a(y).attr("offval")}else if(y[0].type.substr(0,6)=="select")y[0].selectedIndex=0;else y.val(E);if(d.checkOnSubmit===true||d.checkOnUpdate)d._savedData[r]=E}});a("#id_g","#"+z).val("_empty")}else{var S=a(l).jqGrid("getInd",g,true);if(S){a("td",S).each(function(I){r=G[I].name;if(r!=="cb"&&r!=="subgrid"&&r!=="rn"&&G[I].editable===true){if(r==l.p.ExpandColumn&&l.p.treeGrid===true)w=a(this).text();else try{w=a.unformat(this,{colModel:G[I]},I)}catch(X){w=
a(this).html()}if(d.checkOnSubmit===true||d.checkOnUpdate)d._savedData[r]=w;r=a.jgrid.jqID(r);switch(G[I].edittype){case "password":case "text":case "button":case "image":w=a.jgrid.htmlDecode(w);a("#"+r,"#"+z).val(w);break;case "textarea":if(w=="&nbsp;"||w=="&#160;"||w.length==1&&w.charCodeAt(0)==160)w="";a("#"+r,"#"+z).val(w);break;case "select":var Q=w.split(",");Q=a.map(Q,function(W){return a.trim(W)});a("#"+r+" option","#"+z).each(function(){this.selected=!G[I].editoptions.multiple&&(Q[0]==a(this).text()||
Q[0]==a(this).val())?true:G[I].editoptions.multiple?a.inArray(a(this).text(),Q)>-1||a.inArray(a(this).val(),Q)>-1?true:false:false});break;case "checkbox":w+="";w=w.toLowerCase();if(w.search(/(false|0|no|off|undefined)/i)<0&&w!==""){a("#"+r,"#"+z).attr("checked",true);a("#"+r,"#"+z).attr("defaultChecked",true)}else{a("#"+r,"#"+z).attr("checked",false);a("#"+r,"#"+z).attr("defaultChecked","")}break;case "custom":try{if(G[I].editoptions&&a.isFunction(G[I].editoptions.custom_value))G[I].editoptions.custom_value(a("#"+
r,"#"+z),"set",w);else throw"e1";}catch(ba){ba=="e1"?info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.nodefined,jQuery.jgrid.edit.bClose):info_dialog(jQuery.jgrid.errors.errcap,ba.message,jQuery.jgrid.edit.bClose)}break}F++}});F>0&&a("#id_g","#"+i).val(g)}}}function j(){var g,l=[true,"",""],z={};if(a.isFunction(d.beforeCheckValues)){var r=d.beforeCheckValues(c,a("#"+k),c.id=="_empty"?"add":"edit");if(r&&typeof r==="object")c=r}for(var F in c){l=checkValues(c[F],F,
f);if(l[0]==false)break}if(l[0]){if(a.isFunction(d.onclickSubmit))z=d.onclickSubmit(d,c)||{};if(a.isFunction(d.beforeSubmit))l=d.beforeSubmit(c,a("#"+k))}Z=d.url?d.url:a(f).jqGrid("getGridParam","editurl");if(l[0])if(!Z){l[0]=false;l[1]+=" "+a.jgrid.errors.nourl}if(l[0]===false){a("#FormError>td","#"+i).html(l[1]);a("#FormError","#"+i).show()}else if(!b.processing){b.processing=true;a("#sData","#"+i+"_2").addClass("ui-state-active");c.oper=c.id=="_empty"?"add":"edit";c=a.extend(c,d.editData,z);a.ajax(a.extend({url:Z,
type:d.mtype,data:a.isFunction(d.serializeEditData)?d.serializeEditData(c):c,complete:function(w,y){if(y!="success"){l[0]=false;l[1]=a.isFunction(d.errorTextFormat)?d.errorTextFormat(w):y+" Status: '"+w.statusText+"'. Error code: "+w.status}else if(a.isFunction(d.afterSubmit))l=d.afterSubmit(w,c);if(l[0]===false){a("#FormError>td","#"+i).html(l[1]);a("#FormError","#"+i).show()}else{a.each(f.p.colModel,function(){if(u[this.name]&&this.formatter&&this.formatter=="select")try{delete u[this.name]}catch(E){}});
c=a.extend(c,u);if(c.id=="_empty"){l[2]||(l[2]=parseInt(f.p.records)+1);c.id=l[2];if(d.closeAfterAdd){if(d.reloadAfterSubmit)a(f).trigger("reloadGrid");else{a(f).jqGrid("addRowData",l[2],c,b.addedrow);a(f).jqGrid("setSelection",l[2])}hideModal("#"+n.themodal,{gb:"#gbox_"+e,jqm:b.jqModal,onClose:d.onClose})}else if(d.clearAfterAdd){d.reloadAfterSubmit?a(f).trigger("reloadGrid"):a(f).jqGrid("addRowData",l[2],c,b.addedrow);m("_empty",f,k)}else d.reloadAfterSubmit?a(f).trigger("reloadGrid"):a(f).jqGrid("addRowData",
l[2],c,b.addedrow)}else{if(d.reloadAfterSubmit){a(f).trigger("reloadGrid");d.closeAfterEdit||setTimeout(function(){a(f).jqGrid("setSelection",c.id)},1E3)}else f.p.treeGrid===true?a(f).jqGrid("setTreeRow",c.id,c):a(f).jqGrid("setRowData",c.id,c);d.closeAfterEdit&&hideModal("#"+n.themodal,{gb:"#gbox_"+e,jqm:b.jqModal,onClose:d.onClose})}if(a.isFunction(d.afterComplete)){g=w;setTimeout(function(){d.afterComplete(g,c,a("#"+k));g=null},500)}}b.processing=false;if(d.checkOnSubmit||d.checkOnUpdate){a("#"+
k).data("disabled",false);if(d._savedData.id!="_empty")d._savedData=c}a("#sData","#"+i+"_2").removeClass("ui-state-active");try{a(":input:visible","#"+k)[0].focus()}catch(J){}},error:function(w,y,J){a("#FormError>td","#"+i).html(y+" : "+J);a("#FormError","#"+i).show();b.processing=false;a("#"+k).data("disabled",false);a("#sData","#"+i+"_2").removeClass("ui-state-active")}},a.jgrid.ajaxOptions,d.ajaxEditOptions))}}function q(g,l){var z=false,r;for(r in g)if(g[r]!=l[r]){z=true;break}return z}var f=
this;if(f.grid&&h){var e=f.p.id,k="FrmGrid_"+e,i="TblGrid_"+e,n={themodal:"editmod"+e,modalhead:"edithd"+e,modalcontent:"editcnt"+e,scrollelm:k},C=a.isFunction(d.beforeShowForm)?d.beforeShowForm:false,O=a.isFunction(d.afterShowForm)?d.afterShowForm:false,t=a.isFunction(d.beforeInitData)?d.beforeInitData:false,D=a.isFunction(d.onInitializeForm)?d.onInitializeForm:false,B=1,N=0,Z,c,u,H,R;if(h=="new"){h="_empty";b.caption=b.addCaption}else b.caption=b.editCaption;b.recreateForm===true&&a("#"+n.themodal).html()!=
null&&a("#"+n.themodal).remove();var K=true;if(b.checkOnUpdate&&b.jqModal&&!b.modal)K=false;if(a("#"+n.themodal).html()!=null){a(".ui-jqdialog-title","#"+n.modalhead).html(b.caption);a("#FormError","#"+i).hide();if(d.topinfo){a(".topinfo","#"+i+"_2").html(d.topinfo);a(".tinfo","#"+i+"_2").show()}else a(".tinfo","#"+i+"_2").hide();if(d.bottominfo){a(".bottominfo","#"+i+"_2").html(d.bottominfo);a(".binfo","#"+i+"_2").show()}else a(".binfo","#"+i+"_2").hide();t&&t(a("#"+k));m(h,f,k);h=="_empty"?a("#pData, #nData",
"#"+i+"_2").hide():a("#pData, #nData","#"+i+"_2").show();if(b.processing===true){b.processing=false;a("#sData","#"+i+"_2").removeClass("ui-state-active")}if(a("#"+k).data("disabled")===true){a(".confirm","#"+n.themodal).hide();a("#"+k).data("disabled",false)}C&&C(a("#"+k));a("#"+n.themodal).data("onClose",d.onClose);viewModal("#"+n.themodal,{gbox:"#gbox_"+e,jqm:b.jqModal,jqM:false,closeoverlay:K,modal:b.modal});K||a(".jqmOverlay").click(function(){if(!s())return false;hideModal("#"+n.themodal,{gb:"#gbox_"+
e,jqm:b.jqModal,onClose:d.onClose});return false});O&&O(a("#"+k))}else{a(f.p.colModel).each(function(){var g=this.formoptions;B=Math.max(B,g?g.colpos||0:0);N=Math.max(N,g?g.rowpos||0:0)});var L=isNaN(b.dataheight)?b.dataheight:b.dataheight+"px",A;L=a("<form name='FormPost' id='"+k+"' class='FormGrid' style='width:100%;overflow:auto;position:relative;height:"+L+";'></form>").data("disabled",false);var M=a("<table id='"+i+"' class='EditTable' cellspacing='0' cellpading='0' border='0'><tbody></tbody></table>");
a(L).append(M);A=a("<tr id='FormError' style='display:none'><td class='ui-state-error' colspan='"+B*2+"'></td></tr>");A[0].rp=0;a(M).append(A);A=a("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+B*2+"'>"+d.topinfo+"</td></tr>");A[0].rp=0;a(M).append(A);t&&t(a("#"+k));A=(t=f.p.direction=="rtl"?true:false)?"nData":"pData";var T=t?"pData":"nData";p(h,f,M,B);A="<a href='javascript:void(0)' id='"+A+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></div>";
T="<a href='javascript:void(0)' id='"+T+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></div>";var $="<a href='javascript:void(0)' id='sData' class='fm-button ui-state-default ui-corner-all'>"+b.bSubmit+"</a>",aa="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+b.bCancel+"</a>";A="<table border='0' class='EditTable' id='"+i+"_2'><tbody><tr id='Act_Buttons'><td class='navButton ui-widget-content'>"+
(t?T+A:A+T)+"</td><td class='EditButton ui-widget-content'>"+$+aa+"</td></tr>";A+="<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+d.bottominfo+"</td></tr>";A+="</tbody></table>";if(N>0){var V=[];a.each(a(M)[0].rows,function(g,l){V[g]=l});V.sort(function(g,l){if(g.rp>l.rp)return 1;if(g.rp<l.rp)return-1;return 0});a.each(V,function(g,l){a("tbody",M).append(l)})}b.gbox="#gbox_"+e;var ca=false;if(b.closeOnEscape===true){b.closeOnEscape=false;ca=true}L=a("<span></span>").append(L).append(A);
createModal(n,L,b,"#gview_"+f.p.id,a("#gview_"+f.p.id)[0]);if(t){a("#pData, #nData","#"+i+"_2").css("float","right");a(".EditButton","#"+i+"_2").css("text-align","left")}d.topinfo&&a(".tinfo","#"+i+"_2").show();d.bottominfo&&a(".binfo","#"+i+"_2").show();A=L=null;a("#"+n.themodal).keydown(function(g){var l=g.target;if(a("#"+k).data("disabled")===true)return false;if(d.savekey[0]===true&&g.which==d.savekey[1])if(l.tagName!="TEXTAREA"){a("#sData","#"+i+"_2").trigger("click");return false}if(g.which===
27){if(!s())return false;ca&&hideModal(this,{gb:b.gbox,jqm:b.jqModal,onClose:d.onClose});return false}if(d.navkeys[0]===true){if(a("#id_g","#"+i).val()=="_empty")return true;if(g.which==d.navkeys[1]){a("#pData","#"+i+"_2").trigger("click");return false}if(g.which==d.navkeys[2]){a("#nData","#"+i+"_2").trigger("click");return false}}});if(b.checkOnUpdate){a("a.ui-jqdialog-titlebar-close span","#"+n.themodal).removeClass("jqmClose");a("a.ui-jqdialog-titlebar-close","#"+n.themodal).unbind("click").click(function(){if(!s())return false;
hideModal("#"+n.themodal,{gb:"#gbox_"+e,jqm:b.jqModal,onClose:d.onClose});return false})}b.saveicon=a.extend([true,"left","ui-icon-disk"],b.saveicon);b.closeicon=a.extend([true,"left","ui-icon-close"],b.closeicon);if(b.saveicon[0]==true)a("#sData","#"+i+"_2").addClass(b.saveicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+b.saveicon[2]+"'></span>");if(b.closeicon[0]==true)a("#cData","#"+i+"_2").addClass(b.closeicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+
b.closeicon[2]+"'></span>");if(d.checkOnSubmit||d.checkOnUpdate){$="<a href='javascript:void(0)' id='sNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+b.bYes+"</a>";T="<a href='javascript:void(0)' id='nNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+b.bNo+"</a>";aa="<a href='javascript:void(0)' id='cNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+b.bExit+"</a>";L=b.zIndex||999;L++;a("<div class='ui-widget-overlay jqgrid-overlay confirm' style='z-index:"+
L+";display:none;'>&#160;"+(a.browser.msie&&a.browser.version==6?'<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>':"")+"</div><div class='confirm ui-widget-content ui-jqconfirm' style='z-index:"+(L+1)+"'>"+b.saveData+"<br/><br/>"+$+T+aa+"</div>").insertAfter("#"+k);a("#sNew","#"+n.themodal).click(function(){j();a("#"+k).data("disabled",false);a(".confirm","#"+n.themodal).hide();return false});a("#nNew","#"+n.themodal).click(function(){a(".confirm",
"#"+n.themodal).hide();a("#"+k).data("disabled",false);setTimeout(function(){a(":input","#"+k)[0].focus()},0);return false});a("#cNew","#"+n.themodal).click(function(){a(".confirm","#"+n.themodal).hide();a("#"+k).data("disabled",false);hideModal("#"+n.themodal,{gb:"#gbox_"+e,jqm:b.jqModal,onClose:d.onClose});return false})}D&&D(a("#"+k));h=="_empty"?a("#pData,#nData","#"+i+"_2").hide():a("#pData,#nData","#"+i+"_2").show();C&&C(a("#"+k));a("#"+n.themodal).data("onClose",d.onClose);viewModal("#"+n.themodal,
{gbox:"#gbox_"+e,jqm:b.jqModal,closeoverlay:K,modal:b.modal});K||a(".jqmOverlay").click(function(){if(!s())return false;hideModal("#"+n.themodal,{gb:"#gbox_"+e,jqm:b.jqModal,onClose:d.onClose});return false});O&&O(a("#"+k));a(".fm-button","#"+n.themodal).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});a("#sData","#"+i+"_2").click(function(){c={};u={};a("#FormError","#"+i).hide();v();if(c.id=="_empty")j();else if(b.checkOnSubmit===true){H=a.extend({},
c,u);if(R=q(H,d._savedData)){a("#"+k).data("disabled",true);a(".confirm","#"+n.themodal).show()}else j()}else j();return false});a("#cData","#"+i+"_2").click(function(){if(!s())return false;hideModal("#"+n.themodal,{gb:"#gbox_"+e,jqm:b.jqModal,onClose:d.onClose});return false});a("#nData","#"+i+"_2").click(function(){if(!s())return false;a("#FormError","#"+i).hide();var g=x();g[0]=parseInt(g[0]);if(g[0]!=-1&&g[1][g[0]+1]){a.isFunction(b.onclickPgButtons)&&b.onclickPgButtons("next",a("#"+k),g[1][g[0]]);
m(g[1][g[0]+1],f,k);a(f).jqGrid("setSelection",g[1][g[0]+1]);a.isFunction(b.afterclickPgButtons)&&b.afterclickPgButtons("next",a("#"+k),g[1][g[0]+1]);o(g[0]+1,g[1].length-1)}return false});a("#pData","#"+i+"_2").click(function(){if(!s())return false;a("#FormError","#"+i).hide();var g=x();if(g[0]!=-1&&g[1][g[0]-1]){a.isFunction(b.onclickPgButtons)&&b.onclickPgButtons("prev",a("#"+k),g[1][g[0]]);m(g[1][g[0]-1],f,k);a(f).jqGrid("setSelection",g[1][g[0]-1]);a.isFunction(b.afterclickPgButtons)&&b.afterclickPgButtons("prev",
a("#"+k),g[1][g[0]-1]);o(g[0]-1,g[1].length-1)}return false})}C=x();o(C[0],C[1].length-1)}})},viewGridRow:function(h,b){b=a.extend({top:0,left:0,width:0,height:"auto",dataheight:"auto",modal:false,drag:true,resize:true,jqModal:true,closeOnEscape:false,labelswidth:"30%",closeicon:[],navkeys:[false,38,40],onClose:null},a.jgrid.view,b||{});return this.each(function(){function o(){if(b.closeOnEscape===true||b.navkeys[0]===true)setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+e.modalhead).focus()},
0)}function x(c,u){c==0?a("#pData","#"+f+"_2").addClass("ui-state-disabled"):a("#pData","#"+f+"_2").removeClass("ui-state-disabled");c==u?a("#nData","#"+f+"_2").addClass("ui-state-disabled"):a("#nData","#"+f+"_2").removeClass("ui-state-disabled")}function s(){var c=a(m).jqGrid("getDataIDs"),u=a("#id_g","#"+f).val();return[a.inArray(u,c),c]}function v(c,u,H,R){for(var K,L,A,M=0,T,$,aa=[],V=false,ca="<td class='CaptionTD form-view-label ui-widget-content' width='"+b.labelswidth+"'>&#160;</td><td class='DataTD form-view-data ui-helper-reset ui-widget-content'>&#160;</td>",
g="",l=["integer","number","currency"],z=0,r=0,F,w,y,J=1;J<=R;J++)g+=J==1?ca:"<td class='CaptionTD form-view-label ui-widget-content'>&#160;</td><td class='DataTD form-view-data ui-widget-content'>&#160;</td>";a(u.p.colModel).each(function(){L=this.editrules&&this.editrules.edithidden===true?false:this.hidden===true?true:false;if(!L&&this.align==="right")if(this.formatter&&a.inArray(this.formatter,l)!==-1)z=Math.max(z,parseInt(this.width,10));else r=Math.max(r,parseInt(this.width,10))});F=z!==0?z:
r!==0?r:0;V=a(u).jqGrid("getInd",c);a(u.p.colModel).each(function(E){K=this.name;w=false;$=(L=this.editrules&&this.editrules.edithidden===true?false:this.hidden===true?true:false)?"style='display:none'":"";y=typeof this.viewable!="boolean"?true:this.viewable;if(K!=="cb"&&K!=="subgrid"&&K!=="rn"&&y){T=V===false?"":K==u.p.ExpandColumn&&u.p.treeGrid===true?a("td:eq("+E+")",u.rows[V]).text():a("td:eq("+E+")",u.rows[V]).html();w=this.align==="right"&&F!==0?true:false;a.extend({},this.editoptions||{},{id:K,
name:K});var P=a.extend({},{rowabove:false,rowcontent:""},this.formoptions||{}),G=parseInt(P.rowpos)||M+1,S=parseInt((parseInt(P.colpos)||1)*2);if(P.rowabove){var I=a("<tr><td class='contentinfo' colspan='"+R*2+"'>"+P.rowcontent+"</td></tr>");a(H).append(I);I[0].rp=G}A=a(H).find("tr[rowpos="+G+"]");if(A.length==0){A=a("<tr "+$+" rowpos='"+G+"'></tr>").addClass("FormData").attr("id","trv_"+K);a(A).append(g);a(H).append(A);A[0].rp=G}a("td:eq("+(S-2)+")",A[0]).html("<b>"+(typeof P.label==="undefined"?
u.p.colNames[E]:P.label)+"</b>");a("td:eq("+(S-1)+")",A[0]).append("<span>"+T+"</span>").attr("id","v_"+K);w&&a("td:eq("+(S-1)+") span",A[0]).css({"text-align":"right",width:F+"px"});aa[M]=E;M++}});if(M>0){c=a("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(R*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+c+"'/></td></tr>");c[0].rp=M+99;a(H).append(c)}return aa}function p(c,u){var H,R,K=0,L,A;if(A=a(u).jqGrid("getInd",
c,true)){a("td",A).each(function(M){H=u.p.colModel[M].name;R=u.p.colModel[M].editrules&&u.p.colModel[M].editrules.edithidden===true?false:u.p.colModel[M].hidden===true?true:false;if(H!=="cb"&&H!=="subgrid"&&H!=="rn"){L=H==u.p.ExpandColumn&&u.p.treeGrid===true?a(this).text():a(this).html();a.extend({},u.p.colModel[M].editoptions||{});H=a.jgrid.jqID("v_"+H);a("#"+H+" span","#"+f).html(L);R&&a("#"+H,"#"+f).parents("tr:first").hide();K++}});K>0&&a("#id_g","#"+f).val(c)}}var m=this;if(m.grid&&h){if(!b.imgpath)b.imgpath=
m.p.imgpath;var j=m.p.id,q="ViewGrid_"+j,f="ViewTbl_"+j,e={themodal:"viewmod"+j,modalhead:"viewhd"+j,modalcontent:"viewcnt"+j,scrollelm:q},k=1,i=0;if(a("#"+e.themodal).html()!=null){a(".ui-jqdialog-title","#"+e.modalhead).html(b.caption);a("#FormError","#"+f).hide();p(h,m);viewModal("#"+e.themodal,{gbox:"#gbox_"+j,jqm:b.jqModal,jqM:false,modal:b.modal});o()}else{a(m.p.colModel).each(function(){var c=this.formoptions;k=Math.max(k,c?c.colpos||0:0);i=Math.max(i,c?c.rowpos||0:0)});var n=isNaN(b.dataheight)?
b.dataheight:b.dataheight+"px",C=a("<form name='FormPost' id='"+q+"' class='FormGrid' style='width:100%;overflow:auto;position:relative;height:"+n+";'></form>"),O=a("<table id='"+f+"' class='EditTable' cellspacing='1' cellpading='2' border='0' style='table-layout:fixed'><tbody></tbody></table>");a(C).append(O);v(h,m,O,k);n=m.p.direction=="rtl"?true:false;var t="<a href='javascript:void(0)' id='"+(n?"nData":"pData")+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></div>",
D="<a href='javascript:void(0)' id='"+(n?"pData":"nData")+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></div>",B="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+b.bClose+"</a>";if(i>0){var N=[];a.each(a(O)[0].rows,function(c,u){N[c]=u});N.sort(function(c,u){if(c.rp>u.rp)return 1;if(c.rp<u.rp)return-1;return 0});a.each(N,function(c,u){a("tbody",O).append(u)})}b.gbox="#gbox_"+j;var Z=false;if(b.closeOnEscape===
true){b.closeOnEscape=false;Z=true}C=a("<span></span>").append(C).append("<table border='0' class='EditTable' id='"+f+"_2'><tbody><tr id='Act_Buttons'><td class='navButton ui-widget-content' width='"+b.labelswidth+"'>"+(n?D+t:t+D)+"</td><td class='EditButton ui-widget-content'>"+B+"</td></tr></tbody></table>");createModal(e,C,b,"#gview_"+m.p.id,a("#gview_"+m.p.id)[0]);if(n){a("#pData, #nData","#"+f+"_2").css("float","right");a(".EditButton","#"+f+"_2").css("text-align","left")}C=null;a("#"+e.themodal).keydown(function(c){if(c.which===
27){Z&&hideModal(this,{gb:b.gbox,jqm:b.jqModal,onClose:b.onClose});return false}if(b.navkeys[0]===true){if(c.which===b.navkeys[1]){a("#pData","#"+f+"_2").trigger("click");return false}if(c.which===b.navkeys[2]){a("#nData","#"+f+"_2").trigger("click");return false}}});b.closeicon=a.extend([true,"left","ui-icon-close"],b.closeicon);if(b.closeicon[0]==true)a("#cData","#"+f+"_2").addClass(b.closeicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+b.closeicon[2]+
"'></span>");viewModal("#"+e.themodal,{gbox:"#gbox_"+j,jqm:b.jqModal,modal:b.modal});a(".fm-button:not(.ui-state-disabled)","#"+f+"_2").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});o();a("#cData","#"+f+"_2").click(function(){hideModal("#"+e.themodal,{gb:"#gbox_"+j,jqm:b.jqModal,onClose:b.onClose});return false});a("#nData","#"+f+"_2").click(function(){a("#FormError","#"+f).hide();var c=s();c[0]=parseInt(c[0]);if(c[0]!=-1&&c[1][c[0]+1]){a.isFunction(b.onclickPgButtons)&&
b.onclickPgButtons("next",a("#"+q),c[1][c[0]]);p(c[1][c[0]+1],m);a(m).jqGrid("setSelection",c[1][c[0]+1]);a.isFunction(b.afterclickPgButtons)&&b.afterclickPgButtons("next",a("#"+q),c[1][c[0]+1]);x(c[0]+1,c[1].length-1)}o();return false});a("#pData","#"+f+"_2").click(function(){a("#FormError","#"+f).hide();var c=s();if(c[0]!=-1&&c[1][c[0]-1]){a.isFunction(b.onclickPgButtons)&&b.onclickPgButtons("prev",a("#"+q),c[1][c[0]]);p(c[1][c[0]-1],m);a(m).jqGrid("setSelection",c[1][c[0]-1]);a.isFunction(b.afterclickPgButtons)&&
b.afterclickPgButtons("prev",a("#"+q),c[1][c[0]-1]);x(c[0]-1,c[1].length-1)}o();return false})}n=s();x(n[0],n[1].length-1)}})},delGridRow:function(h,b){d=b=a.extend({top:0,left:0,width:240,height:"auto",dataheight:"auto",modal:false,drag:true,resize:true,url:"",mtype:"POST",reloadAfterSubmit:true,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,jqModal:true,closeOnEscape:false,delData:{},delicon:[],cancelicon:[],onClose:null,ajaxDelOptions:{},serializeDelData:null},
a.jgrid.del,b||{});return this.each(function(){var o=this;if(o.grid)if(h){var x=typeof b.beforeShowForm==="function"?true:false,s=typeof b.afterShowForm==="function"?true:false,v=o.p.id,p={},m="DelTbl_"+v,j={themodal:"delmod"+v,modalhead:"delhd"+v,modalcontent:"delcnt"+v,scrollelm:m};if(isArray(h))h=h.join();if(a("#"+j.themodal).html()!=null){a("#DelData>td","#"+m).text(h);a("#DelError","#"+m).hide();if(b.processing===true){b.processing=false;a("#dData","#"+m).removeClass("ui-state-active")}x&&b.beforeShowForm(a("#"+
m));viewModal("#"+j.themodal,{gbox:"#gbox_"+v,jqm:b.jqModal,jqM:false,modal:b.modal})}else{var q=isNaN(b.dataheight)?b.dataheight:b.dataheight+"px";q="<div id='"+m+"' class='formdata' style='width:100%;overflow:auto;position:relative;height:"+q+";'>";q+="<table class='DelTable'><tbody>";q+="<tr id='DelError' style='display:none'><td class='ui-state-error'></td></tr>";q+="<tr id='DelData' style='display:none'><td >"+h+"</td></tr>";q+='<tr><td class="delmsg" style="white-space:pre;">'+b.msg+"</td></tr><tr><td >&#160;</td></tr>";
q+="</tbody></table></div>";q+="<table cellspacing='0' cellpadding='0' border='0' class='EditTable' id='"+m+"_2'><tbody><tr><td class='DataTD ui-widget-content'></td></tr><tr style='display:block;height:3px;'><td></td></tr><tr><td class='DelButton EditButton'>"+("<a href='javascript:void(0)' id='dData' class='fm-button ui-state-default ui-corner-all'>"+b.bSubmit+"</a>")+"&#160;"+("<a href='javascript:void(0)' id='eData' class='fm-button ui-state-default ui-corner-all'>"+b.bCancel+"</a>")+"</td></tr></tbody></table>";
b.gbox="#gbox_"+v;createModal(j,q,b,"#gview_"+o.p.id,a("#gview_"+o.p.id)[0]);a(".fm-button","#"+m+"_2").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});b.delicon=a.extend([true,"left","ui-icon-scissors"],b.delicon);b.cancelicon=a.extend([true,"left","ui-icon-cancel"],b.cancelicon);if(b.delicon[0]==true)a("#dData","#"+m+"_2").addClass(b.delicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+b.delicon[2]+
"'></span>");if(b.cancelicon[0]==true)a("#eData","#"+m+"_2").addClass(b.cancelicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+b.cancelicon[2]+"'></span>");a("#dData","#"+m+"_2").click(function(){var f=[true,""];p={};var e=a("#DelData>td","#"+m).text();if(typeof b.onclickSubmit==="function")p=b.onclickSubmit(d)||{};if(typeof b.beforeSubmit==="function")f=b.beforeSubmit(e);if(f[0]){var k=d.url?d.url:a(o).jqGrid("getGridParam","editurl");if(!k){f[0]=false;
f[1]+=" "+a.jgrid.errors.nourl}}if(f[0]===false){a("#DelError>td","#"+m).html(f[1]);a("#DelError","#"+m).show()}else if(!b.processing){b.processing=true;a(this).addClass("ui-state-active");var i=a.extend({oper:"del",id:e},d.delData,p);a.ajax(a.extend({url:k,type:b.mtype,data:a.isFunction(b.serializeDelData)?b.serializeDelData(i):i,complete:function(n,C){if(C!="success"){f[0]=false;f[1]=a.isFunction(d.errorTextFormat)?d.errorTextFormat(n):C+" Status: '"+n.statusText+"'. Error code: "+n.status}else if(typeof d.afterSubmit===
"function")f=d.afterSubmit(n,i);if(f[0]===false){a("#DelError>td","#"+m).html(f[1]);a("#DelError","#"+m).show()}else{if(d.reloadAfterSubmit){o.p.treeGrid&&a(o).jqGrid("setGridParam",{treeANode:0,datatype:o.p.treedatatype});a(o).trigger("reloadGrid")}else{C=[];C=e.split(",");if(o.p.treeGrid===true)try{a(o).jqGrid("delTreeNode",C[0])}catch(O){}else for(var t=0;t<C.length;t++)a(o).jqGrid("delRowData",C[t]);o.p.selrow=null;o.p.selarrrow=[]}a.isFunction(d.afterComplete)&&setTimeout(function(){d.afterComplete(n,
e)},500)}b.processing=false;a("#dData","#"+m+"_2").removeClass("ui-state-active");f[0]&&hideModal("#"+j.themodal,{gb:"#gbox_"+v,jqm:b.jqModal,onClose:d.onClose})},error:function(n,C,O){a("#DelError>td","#"+m).html(C+" : "+O);a("#DelError","#"+m).show();b.processing=false;a("#dData","#"+m+"_2").removeClass("ui-state-active")}},a.jgrid.ajaxOptions,b.ajaxDelOptions))}return false});a("#eData","#"+m+"_2").click(function(){hideModal("#"+j.themodal,{gb:"#gbox_"+v,jqm:b.jqModal,onClose:d.onClose});return false});
x&&b.beforeShowForm(a("#"+m));viewModal("#"+j.themodal,{gbox:"#gbox_"+v,jqm:b.jqModal,modal:b.modal})}s&&b.afterShowForm(a("#"+m));b.closeOnEscape===true&&setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+j.modalhead).focus()},0)}})},navGrid:function(h,b,o,x,s,v,p){b=a.extend({edit:true,editicon:"ui-icon-pencil",add:true,addicon:"ui-icon-plus",del:true,delicon:"ui-icon-trash",search:true,searchicon:"ui-icon-search",refresh:true,refreshicon:"ui-icon-refresh",refreshstate:"firstpage",view:false,
viewicon:"ui-icon-document",position:"left",closeOnEscape:true,afterRefresh:null},a.jgrid.nav,b||{});return this.each(function(){var m={themodal:"alertmod",modalhead:"alerthd",modalcontent:"alertcnt"},j=this,q,f,e;if(j.grid){if(a("#"+m.themodal).html()==null){if(typeof window.innerWidth!="undefined"){q=window.innerWidth;f=window.innerHeight}else if(typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!=0){q=document.documentElement.clientWidth;
f=document.documentElement.clientHeight}else{q=1024;f=768}createModal(m,"<div>"+b.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='jqg_alrt'></span></span>",{gbox:"#gbox_"+j.p.id,jqModal:true,drag:true,resize:true,caption:b.alertcap,top:f/2-25,left:q/2-100,width:200,height:"auto",closeOnEscape:b.closeOnEscape},"","",true)}q=a("<table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table navtable' style='float:left;table-layout:auto;'><tbody><tr></tr></tbody></table>");f=a(j.p.pager).attr("id")||
"pager";j.p.direction=="rtl"&&a(q).attr("dir","rtl").css("float","right");if(b.add){x=x||{};e=a("<td class='ui-pg-button ui-corner-all'></td>");a(e).append("<div class='ui-pg-div'><span class='ui-icon "+b.addicon+"'></span>"+b.addtext+"</div>");a("tr",q).append(e);a(e,q).attr({title:b.addtitle||"",id:x.id||"add_"+j.p.id}).click(function(){typeof b.addfunc=="function"?b.addfunc():a(j).jqGrid("editGridRow","new",x);return false}).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});
e=null}if(b.edit){e=a("<td class='ui-pg-button ui-corner-all'></td>");o=o||{};a(e).append("<div class='ui-pg-div'><span class='ui-icon "+b.editicon+"'></span>"+b.edittext+"</div>");a("tr",q).append(e);a(e,q).attr({title:b.edittitle||"",id:o.id||"edit_"+j.p.id}).click(function(){var k=j.p.selrow;if(k)typeof b.editfunc=="function"?b.editfunc(k):a(j).jqGrid("editGridRow",k,o);else{viewModal("#"+m.themodal,{gbox:"#gbox_"+j.p.id,jqm:true});a("#jqg_alrt").focus()}return false}).hover(function(){a(this).addClass("ui-state-hover")},
function(){a(this).removeClass("ui-state-hover")});e=null}if(b.view){e=a("<td class='ui-pg-button ui-corner-all'></td>");p=p||{};a(e).append("<div class='ui-pg-div'><span class='ui-icon "+b.viewicon+"'></span>"+b.viewtext+"</div>");a("tr",q).append(e);a(e,q).attr({title:b.viewtitle||"",id:p.id||"view_"+j.p.id}).click(function(){var k=j.p.selrow;if(k)a(j).jqGrid("viewGridRow",k,p);else{viewModal("#"+m.themodal,{gbox:"#gbox_"+j.p.id,jqm:true});a("#jqg_alrt").focus()}return false}).hover(function(){a(this).addClass("ui-state-hover")},
function(){a(this).removeClass("ui-state-hover")});e=null}if(b.del){e=a("<td class='ui-pg-button ui-corner-all'></td>");s=s||{};a(e).append("<div class='ui-pg-div'><span class='ui-icon "+b.delicon+"'></span>"+b.deltext+"</div>");a("tr",q).append(e);a(e,q).attr({title:b.deltitle||"",id:s.id||"del_"+j.p.id}).click(function(){var k;if(j.p.multiselect){k=j.p.selarrrow;if(k.length==0)k=null}else k=j.p.selrow;if(k)a(j).jqGrid("delGridRow",k,s);else{viewModal("#"+m.themodal,{gbox:"#gbox_"+j.p.id,jqm:true});
a("#jqg_alrt").focus()}return false}).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});e=null}if(b.add||b.edit||b.del||b.view)a("tr",q).append("<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>");if(b.search){e=a("<td class='ui-pg-button ui-corner-all'></td>");v=v||{};a(e).append("<div class='ui-pg-div'><span class='ui-icon "+b.searchicon+"'></span>"+b.searchtext+"</div>");a("tr",q).append(e);
a(e,q).attr({title:b.searchtitle||"",id:v.id||"search_"+j.p.id}).click(function(){a(j).jqGrid("searchGrid",v);return false}).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});e=null}if(b.refresh){e=a("<td class='ui-pg-button ui-corner-all'></td>");a(e).append("<div class='ui-pg-div'><span class='ui-icon "+b.refreshicon+"'></span>"+b.refreshtext+"</div>");a("tr",q).append(e);a(e,q).attr({title:b.refreshtitle||"",id:"refresh_"+j.p.id}).click(function(){j.p.search=
false;try{a("#fbox_"+j.p.id).searchFilter().reset();j.clearToolbar(false)}catch(k){}switch(b.refreshstate){case "firstpage":a(j).trigger("reloadGrid",[{page:1}]);break;case "current":a(j).trigger("reloadGrid",[{current:true}]);break}a.isFunction(b.afterRefresh)&&b.afterRefresh();return false}).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});e=null}e=a(".ui-jqgrid").css("font-size")||"11px";a("body").append("<div id='testpg2' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+
e+";visibility:hidden;' ></div>");e=a(q).clone().appendTo("#testpg2").width();a("#testpg2").remove();a("#"+f+"_"+b.position,"#"+f).append(q);if(j.p._nvtd){if(e>j.p._nvtd[0]){a("#"+f+"_"+b.position,"#"+f).width(e);j.p._nvtd[0]=e}j.p._nvtd[1]=e}}})},navButtonAdd:function(h,b){b=a.extend({caption:"newButton",title:"",buttonicon:"ui-icon-newwin",onClickButton:null,position:"last",cursor:"pointer"},b||{});return this.each(function(){if(this.grid){if(h.indexOf("#")!=0)h="#"+h;var o=a(".navtable",h)[0],
x=this;if(o){var s=a("<td></td>");a(s).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'><span class='ui-icon "+b.buttonicon+"'></span>"+b.caption+"</div>");b.id&&a(s).attr("id",b.id);if(b.position=="first")o.rows[0].cells.length===0?a("tr",o).append(s):a("tr td:eq(0)",o).before(s);else a("tr",o).append(s);a(s,o).attr("title",b.title||"").click(function(v){a.isFunction(b.onClickButton)&&b.onClickButton.call(x,v);return false}).hover(function(){a(this).addClass("ui-state-hover")},
function(){a(this).removeClass("ui-state-hover")}).css("cursor",b.cursor?b.cursor:"normal")}}})},navSeparatorAdd:function(h,b){b=a.extend({sepclass:"ui-separator",sepcontent:""},b||{});return this.each(function(){if(this.grid){if(h.indexOf("#")!=0)h="#"+h;var o=a(".navtable",h)[0];if(o){var x="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='"+b.sepclass+"'></span>"+b.sepcontent+"</td>";a("tr",o).append(x)}}})},GridToForm:function(h,b){return this.each(function(){var o=this;
if(o.grid){var x=a(o).jqGrid("getRowData",h);if(x)for(var s in x)a("[name="+s+"]",b).is("input:radio")||a("[name="+s+"]",b).is("input:checkbox")?a("[name="+s+"]",b).each(function(){a(this).val()==x[s]?a(this).attr("checked","checked"):a(this).attr("checked","")}):a("[name="+s+"]",b).val(x[s])}})},FormToGrid:function(h,b,o,x){return this.each(function(){var s=this;if(s.grid){o||(o="set");x||(x="first");var v=a(b).serializeArray(),p={};a.each(v,function(m,j){p[j.name]=j.value});if(o=="add")a(s).jqGrid("addRowData",
h,p,x);else o=="set"&&a(s).jqGrid("setRowData",h,p)}})}})})(jQuery);
