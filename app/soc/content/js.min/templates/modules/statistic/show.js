(function(){var c=window.melange;this.prototype=new c.templates._baseTemplate;this.prototype.constructor=c.templates._baseTemplate;c.templates._baseTemplate.apply(this,arguments);var g=this,h=g.context.visualization_types,d="Table",p=g.context.link_id,q=g.context.scope_path,i={},j=[],e=null,f={width:400,height:300},l=function(a){var b=c.graph.allCharts[d].default_options;jQuery.extend(b,a);var k=new c.graph[d]("div_json",i[e],b,function(){k.drawIntoContainer()})},r=function(){var a={};a.width=parseInt(jQuery("#input_width_value").val(),
10);a.height=parseInt(jQuery("#input_height_value").val(),10);l(a)},s=function(a){var b="<div id='div_change_options'>";if(a.change_size){a=["Change visualization size:<br />Width: <input id='input_width_value' value='",f.width,"' maxlength='3'></input><br /> Height:<input id='input_height_value' value='",f.height,"' maxlength='3'></input><br />"].join("");b+=a}b+="<input id='input_change_commit' type='button' value='Change'></div>";return b},m=function(){jQuery.get("/statistic/get_json_response/"+
q+"/"+p,{statistic_name:e},function(a){i[e]=a;d="Table";jQuery("#div_change_options").remove();l()},"json")},n=function(a){d=a.target.value;a=c.graph.allCharts[d].default_options;var b={change_size:true};jQuery("#div_change_options").remove();if(d!=="Table"){jQuery("#div_change_chart_options").append(s(b));a.height=f.height;a.width=f.width}jQuery("#input_change_commit").bind("click",r);var k=new c.graph[d]("div_json",i[e],a,function(){k.drawIntoContainer()})},t=function(){return j[0]},u=function(){jQuery.each(h,
function(a){j.push(a)})},v=function(){var a="";jQuery.each(h,function(b){a+=["<option value='",b,"'>",b,"</option>"].join("")});return a},o=function(){var a="";jQuery.each(h[e],function(){a+=["<option value='",this,"'>",this,"</option>"].join("")});return a};jQuery(function(){u();if(j.length>1){var a=v();jQuery("#div_switch_statistic").append(["Show statistic: <select id='select_switch_statistic'>",a,"</select>"].join(""));jQuery("#select_switch_statistic").bind("change",function(b){e=b.target.value;
m();b=o();jQuery("#select_switch_visualization").replaceWith(["<select id='select_switch_visualization'>",b,"</select>"].join(""));jQuery("#select_switch_visualization").bind("change",n)})}e=t();a=o();jQuery("#div_switch_visualization").append(["Show visualization: <select id='select_switch_visualization'>",a,"</select>"].join(""));jQuery("#select_switch_visualization").bind("change",n);m()})})();
