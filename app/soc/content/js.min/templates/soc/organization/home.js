(function(){function o(){var e=new google.maps.Icon;e.shadow="http://www.google.com/mapfiles/shadow50.png";e.iconSize=new google.maps.Size(20,34);e.shadowSize=new google.maps.Size(37,34);e.iconAnchor=new google.maps.Point(9,34);e.infoWindowAnchor=new google.maps.Point(9,2);e.infoShadowAnchor=new google.maps.Point(18,25);var l=new google.maps.Icon(e);l.image="http://www.google.com/mapfiles/marker.png";var m=new google.maps.Icon(e);m.image="/soc/content/images/mentor-marker.png";if(google.maps.BrowserIsCompatible()){f=
new google.maps.Map2(document.getElementById(p));f.addControl(new google.maps.LargeMapControl);f.addControl(new google.maps.MapTypeControl);f.setCenter(new google.maps.LatLng(0,0),1);var j={},k={},n=[];jQuery.each(h.people,function(b,a){if(a.type==="student")k[b]={name:a.name,lat:a.lat,lon:a.lon,projects:a.projects};if(a.type==="mentor")j[b]={name:a.name,lat:a.lat,lon:a.lon,projects:a.projects}});jQuery.each(h.projects,function(b,a){b=k[a.student_key];a=j[a.mentor_key];b!==undefined&&a!==undefined&&
b.lat!==null&&b.lon!==null&&a.lat!==null&&a.lon!==null&&n.push([[b.lat,b.lon],[a.lat,a.lon]])});jQuery.each(k,function(b,a){var c="",d=null;if(a.lat!==null&&a.lon!==null){b=new google.maps.LatLng(a.lat,a.lon);d=new google.maps.Marker(b,l);c=["<strong>",a.name,"</strong><br /><span style='font-style:italic;'>Student</span><br /><div style='height:100px;width:300px;overflow:auto;font-size:70%'>"].join("");jQuery.each(a.projects,function(){var g=h.projects[this];c+=["<a href='",g.redirect,"'>",g.title,
"</a><br />Mentor: ",g.mentor_name,"<br />"].join("")});c+="</div>";google.maps.Event.addListener(d,"click",function(){d.openInfoWindowHtml(c)});f.addOverlay(d)}});jQuery.each(j,function(b,a){var c="",d=null;if(a.lat!==null&&a.lon!==null){b=new google.maps.LatLng(a.lat,a.lon);d=new google.maps.Marker(b,m);c=["<strong>",a.name,"</strong><br /><span style='font-style:italic;'>Mentor</span><br /><div style='height:100px;width:300px;overflow:auto;font-size:70%'>"].join("");jQuery.each(a.projects,function(){var g=
h.projects[this];c+=["<a href='",g.redirect,"'>",g.title,"</a><br />Student: ",g.student_name,"<br />"].join("")});c+="</div>";google.maps.Event.addListener(d,"click",function(){d.openInfoWindowHtml(c)});f.addOverlay(d)}});jQuery.each(n,function(){var b=new google.maps.LatLng(this[0][0],this[0][1]),a=new google.maps.LatLng(this[1][0],this[1][1]);b=new google.maps.Polyline([b,a],"#ff0000",3);f.addOverlay(b)})}}var i=window.melange;this.prototype=new i.templates._baseTemplate;this.prototype.constructor=
i.templates._baseTemplate;i.templates._baseTemplate.apply(this,arguments);var f,h=this.context.map_data,p="org_home_map";jQuery(function(){i.loadGoogleApi("maps","2",{},o)})})();
